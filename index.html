<!DOCTYPE html>
<html lang="tr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>S Sport Plus - Pusula</title>
  <link rel="stylesheet" href="css/style.css?v=1.2">
  <link rel="icon" type="image/png" href="favicon.png">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
  <!-- Preloader -->
  <div id="app-preloader"
    style="position:fixed;top:0;left:0;width:100%;height:100%;background:#1d1d1d;z-index:9999;display:flex;justify-content:center;align-items:center;">
    <div style="text-align:center;">
      <i class="fas fa-circle-notch fa-spin" style="font-size:3rem;color:#00e5ff;"></i>
      <div style="margin-top:15px;color:#fff;font-family:sans-serif;">Pusula YÃ¼kleniyor...</div>
    </div>
  </div>

  <div id="login-screen" style="display:none !important;">
    <div class="login-card"><img src="favicon.png" alt="Logo" class="login-logo-img">
      <h2 class="login-title">
        <span class="brand-main">S Sport Plus</span>
        <span class="brand-pusula">Pusula</span>
      </h2>
      <p class="login-subtitle" style="opacity:.6;font-size:.9rem;margin-bottom:20px">Personel GiriÅŸi</p><input
        type="text" id="usernameInput" class="login-input" placeholder="KullanÄ±cÄ± AdÄ±"> <input type="password"
        id="passInput" class="login-input" placeholder="Åifre" onkeyup="enterBas(event)"><button class="login-btn"
        onclick="girisYap()">GiriÅŸ Yap</button>
      <div style="margin-top:10px; text-align:center; display:none;">
        <a href="javascript:void(0)" onclick="forgotPasswordPopup()"
          style="color:rgba(255,255,255,0.5); font-size:0.8rem; text-decoration:none;">Åifremi Unuttum?</a>
      </div>
      <div id="loading-msg" class="loading-text">BaÄŸlanÄ±yor...</div>
      <p id="error-msg" style="color:#ef5350;display:none;margin-top:10px;font-size:.9rem">HatalÄ± KullanÄ±cÄ± AdÄ± veya
        Åifre!</p>
    </div>
  </div>
  <div id="maintenance-screen" style="display:none;">
    <div class="maintenance-content" style="text-align:center;color:#fff"><span style="font-size:4rem">ğŸ‘¨ â€ ğŸ«</span>
      <h1>Sistem Mola Verdi!</h1>
      <p>BakÄ±m Ã§alÄ±ÅŸmasÄ± sÃ¼rÃ¼yor... ğŸš€</p>
    </div>
  </div>
  <div id="main-app" style="display:none !important;">
    <div class="header">
      <div class="header-content-limit">
        <div class="header-top">
          <div class="brand-area"><img src="favicon.png" alt="S Sport Logo" class="brand-img">
            <div class="brand-text"><span class="main-text">S Sport Plus</span><span class="sub-text">Temsilci
                PusulasÄ±</span></div>
          </div>
          <div class="header-controls">
            <div class="user-menu-wrapper"><button id="adminBtn" class="user-btn" onclick="toggleUserDropdown()">
                <div class="user-avatar"><i class="fas fa-user" aria-hidden="true"></i></div><span
                  id="user-display">Misafir</span><i class="fas fa-chevron-down" id="user-menu-arrow"
                  style="font-size:.7rem;opacity:.5;transition:.3s"></i>
              </button>
              <div id="userDropdown" class="dropdown-menu">
                <div class="dropdown-header"><span style="font-size:.8rem;color:#999">Hesap Ä°ÅŸlemleri</span></div><a
                  href="javascript:void(0)" class="dropdown-item" onclick="changePasswordPopup()"><i class="fas fa-key"
                    aria-hidden="true"></i>Åifre DeÄŸiÅŸtir</a><a href="javascript:void(0)" class="dropdown-item"
                  id="dropdownImage" style="display:none" onclick="openImageUploader()"><i class="fas fa-image"
                    style="color:var(--info)"></i>GÃ¶rsel YÃ¼kle</a><a href="javascript:void(0)" class="dropdown-item"
                  id="dropdownAddCard" style="display:none" onclick="addNewCardPopup()"><i class="fas fa-plus"
                    style="color:var(--success)"></i>Ä°Ã§erik Ekle</a><a href="javascript:void(0)" class="dropdown-item"
                  id="dropdownQuickEdit" style="display:none" onclick="toggleEditMode()"><i class="fas fa-pen"
                    style="color:var(--secondary)"></i>DÃ¼zenlemeyi AÃ§</a><a href="javascript:void(0)"
                  class="dropdown-item" id="dropdownPerms" style="display:none" onclick="openMenuPermissions()"><i
                    class="fas fa-shield-halved" style="color:var(--secondary)"></i>Yetki YÃ¶netimi</a><a
                  href="javascript:void(0)" class="dropdown-item" id="dropdownActiveUsers" style="display:none"
                  onclick="openActiveUsersPanel()"><i class="fas fa-users" style="color:var(--info)"></i>Aktif
                  KullanÄ±cÄ±lar</a><a href="javascript:void(0)" class="dropdown-item" id="dropdownUserMgmt"
                  style="display:none" onclick="openUserManagementPanel()"><i class="fas fa-user-cog"
                    style="color:var(--accent)"></i>KullanÄ±cÄ± YÃ¶netimi</a><a href="javascript:void(0)"
                  class="dropdown-item" id="dropdownLogs" style="display:none" onclick="openLogsPanel()"><i
                    class="fas fa-history" style="color:var(--info)"></i>Sistem LoglarÄ±</a>
                <div class="dropdown-divider"></div><a href="javascript:void(0)" class="dropdown-item logout"
                  onclick="logout()"><i class="fas fa-sign-out-alt" aria-hidden="true"></i>Ã‡Ä±kÄ±ÅŸ Yap</a>
              </div>
            </div>
          </div>
        </div>
        <div class="control-wrapper">
          <div class="search-container" data-menu-key="search"><i class="fas fa-search search-icon"
              aria-hidden="true"></i><input type="text" id="searchInput" placeholder="Ä°Ã§eriklerde hÄ±zlÄ± ara..."
              onkeyup="filterContent()">
            <div id="searchResultCount" role="status" aria-live="polite"
              style="display:none;margin-top:6px;font-size:0.8rem;color:#777"></div>
          </div>
          <div class="filter-container">
            <button class="filter-btn btn-fav" onclick='filterCategory(this,"fav")'><i class="fas fa-star"
                aria-hidden="true"></i></button>
            <button class="filter-btn btn-home active" data-menu-key="home" onclick='filterCategory(this,"home")'
              aria-label="Ana Sayfa"><i class="fas fa-house" aria-hidden="true"></i>Ana Sayfa</button><button
              class="filter-btn link-btn" data-menu-key="tech" onclick="openTechArea('wizard')" aria-label="Teknik"><i
                class="fas fa-wrench" aria-hidden="true"></i>Teknik</button>
            <button class="filter-btn" data-menu-key="persuasion" onclick='filterCategory(this,"Ä°kna")'><i
                class="fas fa-hand-holding-dollar" aria-hidden="true"></i>Ä°kna</button>
            <button class="filter-btn" data-menu-key="campaign" onclick='filterCategory(this,"Kampanya")'><i
                class="fas fa-gift" aria-hidden="true"></i>Kampanya</button>
            <button class="filter-btn" data-menu-key="info" onclick='filterCategory(this,"Bilgi")'><i
                class="fas fa-info-circle" aria-hidden="true"></i>Bilgi</button>
            <div class="divider"></div>
            <button class="filter-btn link-btn" data-menu-key="broadcast" onclick="openBroadcastFlow()"
              aria-label="YayÄ±n AkÄ±ÅŸÄ±"><i class="fas fa-calendar-alt" aria-hidden="true"></i>YayÄ±n AkÄ±ÅŸÄ±</button>
            <button class="filter-btn link-btn" data-menu-key="guide" onclick="openGuide()" aria-label="Spor Rehberi"><i
                class="fas fa-book" aria-hidden="true"></i>Spor Rehberi</button>
            <button class="filter-btn link-btn" data-menu-key="return" onclick="openWizard()"><i class="fas fa-robot"
                aria-hidden="true"></i>Ä°ade AsistanÄ±</button>

            <button class="filter-btn link-btn" data-menu-key="telesales" onclick="openTelesalesArea()"
              aria-label="TeleSatÄ±ÅŸ"><i class="fas fa-headset" aria-hidden="true"></i>TeleSatÄ±ÅŸ</button>
            <button class="filter-btn link-btn" data-menu-key="game" onclick="openGameHub()" aria-label="Oyun"><i
                class="fas fa-futbol" aria-hidden="true"></i>Oyun</button>
            <button class="filter-btn link-btn" data-menu-key="quality" onclick="openQualityArea()"
              aria-label="Kalite"><i class="fas fa-chart-pie" aria-hidden="true"></i>Kalite</button>
            <button class="filter-btn link-btn" data-menu-key="shift" onclick="openShiftArea()" aria-label="Vardiyam">
              <i class="fas fa-calendar-check" aria-hidden="true">
              </i>Vardiyam</button>
          </div>
        </div>
      </div>
      <div id="global-news-ticker" class="news-ticker-box" data-menu-key="news" onclick="openNews()">
        <div class="ticker-label"><span class="pulse-dot"></span>DUYURU</div>
        <div class="ticker-scroll-wrapper">
          <div id="ticker-content" class="ticker-content">Duyurular yÃ¼kleniyor...</div>
        </div>
      </div>
    </div>
    <div class="container">
      <div id="home-screen" class="home-screen" style="display:none" data-menu-key="home">
        <div class="home-hero">
          <div class="home-hero-left">
            <div class="home-hero-title">ğŸ‘‹ HoÅŸ Geldin, <span id="home-welcome-user">Misafir</span></div>
            <div class="home-hero-sub">GÃ¼ncel duyurular, hÄ±zlÄ± eriÅŸim ve anlÄ±k bilgiler burada.</div>
          </div>
          <div class="home-hero-actions">
            <button class="home-pill" data-menu-key="news" onclick="openNews()"><i class="fas fa-bullhorn"
                aria-hidden="true"></i>
              Duyurular</button>
            <button class="home-pill" data-menu-key="guide" onclick="openGuide()"><i class="fas fa-book"
                aria-hidden="true"></i> Spor
              Rehberi</button>
            <button class="home-pill" data-menu-key="broadcast" onclick="openBroadcastFlow()"><i
                class="fas fa-calendar-alt" aria-hidden="true"></i> YayÄ±n AkÄ±ÅŸÄ±</button>
            <button class="home-pill" data-menu-key="quality" onclick="openQualityArea()"><i class="fas fa-chart-pie"
                aria-hidden="true"></i>
              Kalite</button>
          </div>
        </div>
        <div class="home-grid">
          <div class="home-card">
            <div class="home-card-head">
              <div class="home-card-title"><i class="fas fa-circle-info" aria-hidden="true"></i> BugÃ¼n Neler Var?</div>
              <button class="home-edit" id="home-edit-today" style="display:none" onclick="editHomeBlock('today')"><i
                  class="fas fa-pen" aria-hidden="true"></i></button>
            </div>
            <div id="home-today" class="home-card-body"></div>
          </div>
          <div class="home-card">
            <div class="home-card-head">
              <div class="home-card-title"><i class="fas fa-bullhorn" aria-hidden="true"></i> Duyurular</div>
              <button class="home-edit" id="home-edit-ann" style="display:none" onclick="editHomeBlock('ann')"><i
                  class="fas fa-pen" aria-hidden="true"></i></button>
            </div>
            <div id="home-ann" class="home-card-body"></div>
          </div>
          <div class="home-card">
            <div class="home-card-head">
              <div class="home-card-title"><i class="fas fa-quote-left" aria-hidden="true"></i> GÃ¼nÃ¼n SÃ¶zÃ¼</div>
              <button class="home-edit" id="home-edit-quote" style="display:none" onclick="editHomeBlock('quote')"><i
                  class="fas fa-pen" aria-hidden="true"></i></button>
            </div>
            <div id="home-quote" class="home-quote"></div>
          </div>
          <div class="home-card">
            <div class="home-card-head">
              <div class="home-card-title"><i class="fas fa-bolt" aria-hidden="true"></i> HÄ±zlÄ± KÄ±sayollar</div>
            </div>
            <div class="home-shortcuts">
              <button class="home-chip" data-shortcut-key="tech" onclick="openTechArea('wizard')" aria-label="Teknik"><i
                  class="fas fa-wrench" aria-hidden="true"></i> Teknik</button>
              <button class="home-chip" data-shortcut-key="telesales" onclick="openTelesalesArea()"
                aria-label="TeleSatÄ±ÅŸ"><i class="fas fa-headset" aria-hidden="true"></i> TeleSatÄ±ÅŸ</button>
              <button class="home-chip" data-shortcut-key="return" onclick="openWizard()" aria-label="Ä°ade AsistanÄ±"><i
                  class="fas fa-robot" aria-hidden="true"></i> Ä°ade AsistanÄ±</button>
              <button class="home-chip" data-shortcut-key="game" onclick="openGameHub()" aria-label="Oyun"><i
                  class="fas fa-futbol" aria-hidden="true"></i> Oyun</button>
            </div>
          </div>
          <div class="home-card">
            <div class="home-card-head">
              <div class="home-card-title"><i class="fas fa-trophy" aria-hidden="true"></i> Arena Liderleri</div>
              <button class="home-edit"
                style="display:inline-flex; background:rgba(250, 187, 0, 0.1); color:#fabb00; border:1px solid rgba(250, 187, 0, 0.2);"
                onclick="openPenaltyGame()" title="Arena'ya Git"><i class="fas fa-play"></i></button>
            </div>
            <div id="home-leaderboard-loader" style="text-align:center; padding:15px; color:#999; font-size:0.8rem;">
              YÃ¼kleniyor...</div>
            <table id="home-leaderboard-table"
              style="width:100%; font-size:0.8rem; border-collapse:collapse; display:none; margin-top:5px;">
              <thead>
                <tr
                  style="text-align:center; color:#999; border-bottom:1px solid #eee; font-size:0.7rem; text-transform:uppercase;">
                  <th style="padding:5px 2px">#</th>
                  <th style="padding:5px 2px; text-align:left;">Temsilci</th>
                  <th style="padding:5px 2px">MaÃ§</th>
                  <th style="padding:5px 2px">Ort.</th>
                </tr>
              </thead>
              <tbody id="home-leaderboard-body"></tbody>
            </table>
          </div>
        </div>
      </div>
      <div id="loading" style="text-align:center;padding:40px;color:#999"><i class="fas fa-circle-notch fa-spin fa-2x"
          aria-hidden="true"></i><br><span style="font-size:.9rem;margin-top:10px;display:block">Veriler
          gÃ¼ncelleniyor...</span></div>
      <div class="grid" id="cardGrid"></div>
    </div>
  </div>
  <div id="news-modal" class="modal-overlay">
    <div class="modal-content"><span class="close-modal" onclick='closeModal("news-modal")'>&times;</span>
      <h2 style="color:var(--primary)">ğŸ“¢ Duyurular</h2>
      <div id="news-container"></div>
    </div>
  </div>
  <div id="wizard-modal" class="modal-overlay">
    <div class="modal-content"><span class="close-modal" onclick='closeModal("wizard-modal")'>&times;</span>
      <div id="wizard-body"></div>
    </div>
  </div>
  <div id="tech-wizard-modal" class="modal-overlay">
    <div class="modal-content" style="max-width:900px;padding:0;overflow:hidden;display:flex;flex-direction:column">
      <div
        style="background-color:#0e1b42;color:#fabb00;padding:20px;text-align:center;font-size:1.4rem;font-weight:800;border-bottom:5px solid #fabb00;position:relative">
        ğŸ“º S Sport Plus - Teknik Ã‡Ã¶zÃ¼m SihirbazÄ±<span class="close-modal" onclick='closeModal("tech-wizard-modal")'
          style="color:#fff;top:15px;right:20px">&times;</span></div>
      <div
        style="background-color:#eaeaea;padding:10px 25px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #ccc">
        <button id="tw-btn-back" class="btn btn-copy" style="background:#6c757d;color:#fff;display:none"
          onclick="twGoBack()">â¬… Ã–nceki AdÄ±m</button><button class="btn btn-copy" style="background:#d32f2f;color:#fff"
          onclick="twResetWizard()">â†» Ba ÅŸ a D Ã¶ n</button>
      </div>
      <div id="tech-wizard-content" style="padding:30px;overflow-y:auto;max-height:60vh"></div>
    </div>
  </div>
  <div id="guide-modal" class="modal-overlay">
    <div class="modal-content"><span class="close-modal" onclick='closeModal("guide-modal")'>&times;</span>
      <h2 style="text-align:center;color:var(--primary)">ğŸ“– Spor Terimleri & Ä°Ã§erik Rehberi</h2>
      <div class="guide-grid" id="guide-grid"></div>
    </div>
  </div>
  <div id="sales-modal" class="modal-overlay">
    <div class="modal-content"><span class="close-modal" onclick='closeModal("sales-modal")'>&times;</span>
      <h2 style="text-align:center;color:var(--sales)">ğŸ“ SatÄ±ÅŸ Scriptleri</h2>
      <div class="sales-grid" id="sales-grid"></div>
    </div>
  </div>
  <div id="penalty-modal" class="modal-overlay">
    <div class="modal-content gamer-modal" style="max-width:650px;display:flex;flex-direction:column">
      <span class="close-modal" onclick='closeModal("penalty-modal")'>&times;</span>
      <h2 style="text-align:center;color:#00f2ff;margin-top:0;text-shadow: 0 0 10px rgba(0, 242, 255, 0.7);">âš½ S Sport
        Arena</h2>
      <div id="penalty-lobby"
        style="text-align:center;padding:20px;flex-grow:1;display:flex;flex-direction:column;align-items:center;justify-content:center">
        <h3 style="color:#fff;margin-bottom:15px">ğŸ† Liderlik Tablosu (Top 5)</h3>
        <div id="leaderboard-loader" style="color:#aaa">YÃ¼kleniyor...</div>
        <table id="leaderboard-table"
          style="width:100%;color:#eee;border-collapse:collapse;margin-bottom:30px;display:none">
          <thead>
            <tr style="border-bottom:1px solid #555;color:#fabb00">
              <th style="padding:10px">#</th>
              <th style="padding:10px">Temsilci</th>
              <th style="padding:10px">MaÃ§</th>
              <th style="padding:10px">Ort.</th>
            </tr>
          </thead>
          <tbody id="leaderboard-body"></tbody>
        </table><button class="penalty-btn" style="width:200px;background:#2e7d32;color:#fff;border-color:#1b5e20"
          onclick="startGameFromLobby()">MAÃ‡A BAÅLA ğŸƒ â€ â™‚ï¸âš½</button>
      </div>
      <div id="penalty-game-area" style="display:none">
        <div class="penalty-stats"><span>SKOR:<span id="p-score">0</span></span><span>TOP:<span
              id="p-balls">10</span></span></div>
        <div id="double-indicator" class="double-indicator" style="display:none">2. ÅANS AKTÄ°F</div>
        <div class="penalty-field">
          <div class="stadium-stands"></div>
          <div class="grass-stripes"></div>
          <div class="goal-container">
            <div class="goal-net"></div>
            <div class="goal-top-bar"></div>
            <div class="goal-post-left"></div>
            <div class="goal-post-right"></div>
            <div id="keeper-wrap" class="keeper-wrapper">
              <div class="player-figure">
                <div class="head"></div>
                <div class="torso"></div>
                <div class="arms">
                  <div class="arm left">
                    <div class="gloves"></div>
                  </div>
                  <div class="arm right">
                    <div class="gloves"></div>
                  </div>
                </div>
                <div class="shorts"></div>
                <div class="legs">
                  <div class="leg left"></div>
                  <div class="leg right"></div>
                </div>
              </div>
              <div class="keeper-shadow"></div>
            </div>
          </div>
          <div class="goal-message" id="goal-msg">GOL!</div>
          <div class="penalty-area"></div>
          <div class="penalty-spot-mark"></div>
          <div id="ball-wrap" class="ball-wrapper">
            <div class="football"></div>
            <div class="ball-shadow"></div>
          </div>
          <div id="shooter-wrap" class="shooter-wrapper">
            <div class="player-figure">
              <div class="head"></div>
              <div class="torso"></div>
              <div class="arms">
                <div class="arm left"></div>
                <div class="arm right"></div>
              </div>
              <div class="shorts"></div>
              <div class="legs">
                <div class="leg left">
                  <div class="sock"></div>
                  <div class="shoe"></div>
                </div>
                <div class="leg right">
                  <div class="sock"></div>
                  <div class="shoe"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div
          style="margin-top:15px;color:#ddd;min-height:50px;font-weight:500;text-align:center;padding:10px;background:rgba(255,255,255,.05);border-radius:8px"
          id="p-question-text">Soru yÃ¼kleniyor...</div>
        <div id="joker-container" style="display:flex;justify-content:space-around;margin:15px 0"><button
            id="joker-call" class="joker-btn" onclick='useJoker("call")' title="Telefon Jokeri">ğŸ“
            Telefon</button><button id="joker-half" class="joker-btn" onclick='useJoker("half")'
            title="YarÄ± YarÄ±ya Joker">âœ‚ï¸ 50:50</button><button id="joker-double" class="joker-btn"
            onclick='useJoker("double")' title="Ã‡ift Cevap HakkÄ±">2ï¸ âƒ£ Ã‡ ift Cevap</button></div>
        <div class="penalty-options" id="p-options"></div><button id="p-restart-btn" class="restart-btn"
          style="display:none;width:100%;background:#fabb00;color:#000;font-weight:700" onclick="showLobby()">LOBÄ°YE DÃ–N
          ğŸ </button>
      </div>
    </div>
  </div>

  <div id="quality-fullscreen" class="quality-fullscreen-wrapper" style="display:none">
    <div class="q-sidebar">
      <div class="q-sidebar-header"><i class="fas fa-chart-line fa-lg" aria-hidden="true"></i><span>S Sport
          Pusula</span></div>
      <div class="q-user-profile">
        <div class="q-avatar-circle" id="q-side-avatar">U</div>
        <div class="q-user-info">
          <div class="q-user-name" id="q-side-name">KullanÄ±cÄ± AdÄ±</div>
          <div class="q-user-role" id="q-side-role">Temsilci</div>
        </div>
      </div>
      <ul class="q-nav-menu">
        <li class="q-nav-item active" onclick='switchQualityTab("dashboard")'><i class="fas fa-home"
            aria-hidden="true"></i>Dashboard</li>
        <li class="q-nav-item" onclick='switchQualityTab("evaluations")'><i class="fas fa-list-alt"
            aria-hidden="true"></i>DeÄŸerlendirmeler</li>
        <li class="q-nav-item" onclick='switchQualityTab("feedback")'><i class="fas fa-comment-dots"
            aria-hidden="true"></i>Geri Bildirimler</li>
        <li class="q-nav-item" onclick='switchQualityTab("training")'><i class="fas fa-graduation-cap"
            aria-hidden="true"></i>EÄŸitimlerim</li>
      </ul>
      <div class="q-sidebar-footer"><button onclick="closeFullQuality()" class="q-exit-btn"><i
            class="fas fa-sign-out-alt" aria-hidden="true"></i>Geri</button></div>
    </div>
    <div class="q-content">
      <div id="view-dashboard" class="q-view-section active">
        <div class="q-view-header q-dash-header" style="flex-wrap:wrap;gap:10px">
          <h2>Genel BakÄ±ÅŸ</h2>
          <div class="q-dash-filters">
            <div class="q-filter-item">
              <i class="fas fa-users-viewfinder"></i>
              <select id="q-dash-group" onchange="updateDashAgentList()" class="minimal-select">
                <option value="all">TÃ¼m Gruplar</option>
              </select>
            </div>
            <div class="q-filter-item">
              <i class="fas fa-user-tie"></i>
              <select id="q-dash-agent" onchange="refreshQualityData()" class="minimal-select">
                <option value="all">TÃ¼m Temsilciler</option>
              </select>
            </div>
            <div class="q-filter-item">
              <i class="fas fa-calendar-days"></i>
              <select id="q-dash-month" onchange="refreshQualityData()" class="minimal-select"></select>
            </div>
          </div>
        </div>

        <div class="q-stats-row q-stats-row-4">
          <div class="q-stat-box box-blue">
            <div class="stat-icon"><i class="fas fa-star" aria-hidden="true"></i></div>
            <div class="stat-info"><span class="stat-val" id="q-dash-score">-</span><span class="stat-label">Ortalama
                Puan</span></div>
          </div>
          <div class="q-stat-box box-green">
            <div class="stat-icon"><i class="fas fa-phone-volume" aria-hidden="true"></i></div>
            <div class="stat-info"><span class="stat-val" id="q-dash-count">-</span><span
                class="stat-label">DeÄŸerlendirilen</span></div>
          </div>
          <div class="q-stat-box box-orange">
            <div class="stat-icon"><i class="fas fa-bullseye" aria-hidden="true"></i></div>
            <div class="stat-info"><span class="stat-val" id="q-dash-target">-%</span><span class="stat-label">90+
                OranÄ±</span></div>
          </div>
          <div class="q-stat-box box-red">
            <div class="stat-icon"><i class="fas fa-triangle-exclamation" aria-hidden="true"></i></div>
            <div class="stat-info"><span class="stat-val" id="q-dash-worst">-</span><span class="stat-label">En ZayÄ±f
                Kriter</span></div>
          </div>
        </div>

        <div class="q-dashboard-grid v2">
          <div class="q-chart-card q-card-ring">
            <h3 id="q-dash-ring-title">Puan Durumu</h3>
            <div class="score-circle-outer large-ring" id="q-dash-ring">
              <div class="score-circle-inner" id="q-dash-ring-text">-</div>
            </div>
            <div id="q-dash-agent-scores" class="q-dash-agent-scores" style="display:none"></div>
          </div>

          <div class="q-chart-card q-card-wide">
            <div class="q-card-head">
              <h3>Puan Trendi</h3>
              <div class="q-card-sub" id="q-trend-sub">SeÃ§ili dÃ¶nem gÃ¼nlÃ¼k ortalama</div>
            </div>
            <div class="q-chart-wrap"><canvas id="q-trend-chart"></canvas></div>
          </div>

          <div class="q-chart-card">
            <div class="q-card-head">
              <h3>Kanal DaÄŸÄ±lÄ±mÄ±</h3>
              <div class="q-card-sub" id="q-channel-sub">SatÄ±ÅŸ / Chat</div>
            </div>
            <div class="q-chart-wrap" style="height:230px"><canvas id="q-channel-chart"></canvas></div>
          </div>

          <div class="q-chart-card">
            <div class="q-card-head">
              <h3>Puan DaÄŸÄ±lÄ±mÄ±</h3>
              <div class="q-card-sub">Skor aralÄ±klarÄ±</div>
            </div>
            <div class="q-chart-wrap" style="height:230px"><canvas id="q-score-dist-chart"></canvas></div>
          </div>

          <div class="q-chart-card q-card-wide">
            <div class="q-card-head">
              <h3>Puan KÄ±rÄ±lÄ±mlarÄ±</h3>
              <div class="q-card-sub">En dÃ¼ÅŸÃ¼k 6 kriter</div>
            </div>
            <div class="q-chart-wrap"><canvas id="q-breakdown-chart"></canvas></div>
          </div>

          <div class="q-chart-card q-card-wide">
            <div class="q-card-head">
              <h3>TakÄ±m OrtalamalarÄ±</h3>
              <div class="q-card-sub" id="q-group-sub">En dÃ¼ÅŸÃ¼kten en yÃ¼kseÄŸe</div>
            </div>
            <div class="q-chart-wrap"><canvas id="q-group-avg-chart"></canvas></div>
          </div>
        </div>
      </div>

      <div id="view-evaluations" class="q-view-section">
        <div class="q-view-header">
          <h2>DeÄŸerlendirme GeÃ§miÅŸi</h2>
          <div id="q-admin-filters" style="display:none; margin-left:auto;">
            <div class="q-dash-filters">
              <button class="add-btn" onclick="logEvaluationPopup()">
                <i class="fas fa-plus"></i> Ekle
              </button>
              <button class="admin-btn" onclick="exportEvaluations()" style="background:#4b5563; color:white;">
                <i class="fas fa-file-csv"></i> Rapor
              </button>
              <div class="q-filter-item">
                <i class="fas fa-users"></i>
                <select id="q-admin-group" onchange="updateAgentListBasedOnGroup()" class="minimal-select">
                  <option value="all">TÃ¼m Gruplar</option>
                </select>
              </div>
              <div class="q-filter-item">
                <i class="fas fa-user-tag"></i>
                <select id="q-admin-agent" onchange="fetchEvaluationsForAgent()" class="minimal-select">
                  <option value="all">TÃ¼m Temsilciler</option>
                </select>
              </div>
              <div class="q-filter-item">
                <i class="fas fa-calendar-days"></i>
                <div class="q-period-selector">
                  <span>DÃ¶nem:</span>
                  <select id="q-eval-month" onchange="fetchEvaluationsForAgent()"></select>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="evaluations-list" class="q-scroll-area"></div>
      </div>
      <div id="view-feedback" class="q-view-section">
        <div class="q-view-header">
          <h2>Geri Bildirimler</h2>
          <div id="q-feedback-filters" style="display:flex;gap:10px;margin-left:auto;align-items:center;flex-wrap:wrap">
            <select id="q-feedback-group" onchange="updateFeedbackAgentList()" class="minimal-select"
              style="width:120px">
              <option value="all">TÃ¼m Gruplar</option>
            </select>
            <select id="q-feedback-agent" onchange="refreshFeedbackData()" class="minimal-select" style="width:130px">
              <option value="all">TÃ¼m Temsilciler</option>
            </select>
            <div class="q-period-selector" style="margin-left:5px">
              <span>DÃ¶nem:</span>
              <select id="q-feedback-month" onchange="refreshFeedbackData()" class="minimal-select"></select>
            </div>
          </div>
          <button id="manual-feedback-admin-btn" class="add-manual-feedback-btn" style="display:none"
            onclick="addManualFeedbackPopup()">
            <i class="fas fa-plus-circle" aria-hidden="true"></i> Geri Bildirim Ekle
          </button>
        </div>
        <div id="feedback-list" class="q-scroll-area"></div>
      </div>
      <div id="view-training" class="q-view-section">
        <div class="q-view-header">
          <h2>EÄŸitim & GeliÅŸim</h2>
          <div class="q-training-filters"
            style="display:flex;gap:10px;margin-left:auto;align-items:center;flex-wrap:wrap">
            <div class="search-container" style="width:200px">
              <i class="fas fa-search search-icon"></i>
              <input type="text" id="q-training-search" oninput="filterTrainingList()" placeholder="EÄŸitim ara..."
                style="height:32px; font-size:0.8rem; padding-left:30px">
            </div>
            <select id="q-training-filter-type" onchange="filterTrainingList()" class="minimal-select"
              style="height:32px; font-size:0.8rem">
              <option value="all">TÃ¼m BaÅŸlÄ±klar</option>
              <option value="Genel">Genel</option>
              <option value="TelesatÄ±ÅŸ">TelesatÄ±ÅŸ</option>
              <option value="Chat">Chat</option>
              <option value="Individual">KiÅŸiye Ã–zel</option>
            </select>
            <button id="assign-training-btn" class="add-btn" style="display:none; height:32px"
              onclick="assignTrainingPopup()">
              <i class="fas fa-plus"></i> Ata
            </button>
          </div>
        </div>
        <div id="training-list" class="q-training-grid"></div>
      </div>
    </div>
  </div>
  <div class="crafted-by-badge">Crafted by DoÄŸuÅŸ YalÃ§Ä±nkaya</div>
  <script src="jss/app.js?v=1.2"></script>
  <script>function toggleUserDropdown() {
      const dropdown = document.getElementById('userDropdown');
      const arrow = document.getElementById('user-menu-arrow');
      dropdown.classList.toggle('show');
      if (dropdown.classList.contains('show')) {
        arrow.style.transform = 'rotate(180deg)';
      } else {
        arrow.style.transform = 'rotate(0deg)';
      }
    }
    window.addEventListener('click', function (e) {
      if (!document.getElementById('adminBtn').contains(e.target)) {
        const dropdown = document.getElementById('userDropdown');
        const arrow = document.getElementById('user-menu-arrow');
        if (dropdown.classList.contains('show')) {
          dropdown.classList.remove('show');
          arrow.style.transform = 'rotate(0deg)';
        }
      }
    });
    window.openUserMenu = function () {
      toggleUserDropdown();
    };

    // Duyuru barÄ±ndaki akan metinde [GG.AA.YYYY] formatÄ±ndaki tarihi otomatik span'leyip
    // kurumsal gri (var(--corp-gray)) ile boyayalÄ±m.
    (function () {
      const el = document.getElementById('ticker-content');
      if (!el) return;

      function wrapTickerDates() {
        const html = el.innerHTML;
        // AynÄ± iÃ§eriÄŸi tekrar tekrar sarmamak iÃ§in
        if (html.includes('ticker-date')) return;

        const re = /\[(\d{2}\.\d{2}\.\d{4})\]/g;
        const next = html.replace(re, '<span class="ticker-date">[$1]</span>');
        if (next !== html) el.innerHTML = next;
      }

      wrapTickerDates();
      const obs = new MutationObserver(() => wrapTickerDates());
      obs.observe(el, { childList: true, subtree: true, characterData: true });
    })();
  </script>
  <div id="game-hub-modal" class="modal-overlay">
    <div class="modal-content gamer-modal" style="max-width:760px"><span class="close-modal"
        onclick='closeModal("game-hub-modal")'>&times;</span>
      <h2 style="text-align:center;color:#00f2ff;margin-top:0">ğŸ® Oyun Merkezi</h2>
      <p style="text-align:center;margin-top:-10px">Ä°stersen hÄ±zlÄ± eÄŸitim oyunu, istersen arena!</p>
      <div class="game-hub-grid">
        <div class="game-hub-card" onclick="openQuickDecisionGame()">
          <div class="gh-icon">ğŸ§ </div>
          <div class="gh-title">HÄ±zlÄ± Karar</div>
          <div class="gh-desc">30 sn / 5 senaryo â€¢ Ä°kna + Teknik refleksi</div>
          <div class="gh-cta">BaÅŸlat</div>
        </div>
        <div class="game-hub-card" onclick="openPenaltyGame()">
          <div class="gh-icon">âš½</div>
          <div class="gh-title">S Sport Arena</div>
          <div class="gh-desc">Liderlik tablosu â€¢ 10 top â€¢ Jokerli</div>
          <div class="gh-cta">Arenaya Gir</div>
        </div>
      </div>
    </div>
  </div>
  <div id="quick-modal" class="modal-overlay">
    <div class="modal-content gamer-modal" style="max-width:760px"><span class="close-modal"
        onclick='closeModal("quick-modal")'>&times;</span>
      <h2 style="text-align:center;color:#00f2ff;margin-top:0">ğŸ§  HÄ±zlÄ± Karar</h2>
      <div class="quick-topbar">
        <div class="quick-chip">SÃ¼re:<span id="qd-time">30</span>sn</div>
        <div class="quick-chip">Soru:<span id="qd-step">0</span>/5</div>
        <div class="quick-chip">Puan:<span id="qd-score">0</span></div>
      </div>
      <div id="qd-lobby" class="quick-lobby">
        <p style="margin:0;line-height:1.6">30 saniyede 5 senaryo. En doÄŸru yaklaÅŸÄ±mÄ± seÃ§, puanÄ± kap! ğŸ¯</p>
        <button class="btn btn-copy" style="margin-top:15px;justify-content:center"
          onclick="startQuickDecision()">BaÅŸlat</button>
      </div>
      <div id="qd-game" style="display:none">
        <div class="quick-question" id="qd-question">Soru yÃ¼kleniyor...</div>
        <div class="quick-options" id="qd-options"></div>
        <div class="quick-footer"><button class="btn btn-link" onclick="resetQuickDecision()">Yeniden
            BaÅŸla</button><button class="btn btn-copy" onclick='closeModal("quick-modal")'>Kapat</button></div>
      </div>
    </div>
  </div>
  <div id="telesales-fullscreen" class="q-fullscreen" style="display:none">
    <div class="q-sidebar">
      <div class="q-side-top telesales-side-top">
        <div class="q-side-header">
          <div class="q-module-title"><i class="fas fa-headset" aria-hidden="true"></i> TeleSatÄ±ÅŸ</div>
          <button class="q-close" onclick="closeFullTelesales()"><i class="fas fa-times"
              aria-hidden="true"></i></button>
        </div>
        <div class="q-user-row">
          <div class="q-avatar" id="t-side-avatar">U</div>
          <div class="q-user">
            <div class="q-name" id="t-side-name">KullanÄ±cÄ±</div>
            <div class="q-role" id="t-side-role">Temsilci</div>
          </div>
        </div>
      </div>
      <div class="q-nav-menu">
        <div class="q-nav-item active" onclick="switchTelesalesTab('data')"><i class="fas fa-database"
            aria-hidden="true"></i> Data Teklifleri</div>
        <div class="q-nav-item" onclick="switchTelesalesTab('scripts')"><i class="fas fa-scroll" aria-hidden="true"></i>
          Scriptler</div>
      </div>
      <div class="q-side-bottom">
        <button class="q-logout" onclick="closeFullTelesales()"><i class="fas fa-arrow-left" aria-hidden="true"></i>
          Geri</button>
      </div>
    </div>
    <div class="q-main">
      <div class="q-topbar">
        <div class="q-title">TeleSatÄ±ÅŸ</div>
      </div>
      <div class="q-view">
        <section id="t-view-data" class="q-view-section active">
          <div class="q-toolbar">
            <input id="t-data-search" class="q-input" placeholder="Teklif ara..." oninput="renderTelesalesDataOffers()">
            <div class="q-count" id="t-data-count"></div>
          </div>
          <div id="t-data-grid" class="q-card-grid"></div>
        </section>
        <section id="t-view-scripts" class="q-view-section">
          <div class="q-toolbar"><input id="t-scripts-search" class="q-input" placeholder="Script ara..."
              oninput="renderTelesalesScripts()"></div>
          <div id="t-scripts-grid" class="q-list"></div>
        </section>
      </div>
    </div>
  </div>

  <div id="shift-fullscreen" class="q-fullscreen" style="display:none">
    <div class="q-sidebar">
      <div class="q-sidebar-header">
        <i class="fas fa-calendar-check fa-lg" aria-hidden="true"></i>
        <span>Vardiyam</span>
      </div>
      <div class="q-user-profile">
        <div class="q-avatar-circle" id="shift-side-avatar">U</div>
        <div class="q-user-info">
          <div class="q-user-name" id="shift-side-name">KullanÄ±cÄ± AdÄ±</div>
          <div class="q-user-role" id="shift-side-role">Temsilci</div>
        </div>
      </div>
      <ul class="q-nav-menu">
        <li class="q-nav-item active" data-shift-tab="plan" onclick="switchShiftTab('plan')">
          <i class="fas fa-calendar-week" aria-hidden="true"></i>Vardiya PlanÄ±m
        </li>

      </ul>
      <div class="q-sidebar-footer">
        <button onclick="closeFullShift()" class="q-exit-btn">
          <i class="fas fa-sign-out-alt" aria-hidden="true"></i>Geri
        </button>
      </div>
    </div>
    <div class="q-content">
      <div id="shift-view-plan" class="q-view-section active">
        <div class="q-view-header q-dash-header" style="flex-wrap:wrap;gap:10px">
          <h2>Vardiya PlanÄ±m</h2>
          <div id="shift-week-label" class="shift-week-info"></div>
          <div id="shift-admin-filters" style="display:none; margin-left:auto;"></div>
        </div>
        <div id="shift-plan-my" class="shift-plan-card">
          <!-- KullanÄ±cÄ±nÄ±n kendi vardiyasÄ± burada gÃ¶sterilecek -->
        </div>
        <div class="shift-plan-table-wrapper">
          <h3 style="margin-bottom:8px;">TakÄ±m Vardiya Tablosu</h3>
          <div id="shift-plan-table"></div>
        </div>
      </div>
    </div>
  </div>
  <div id="tech-fullscreen" class="q-fullscreen" style="display:none">
    <div class="q-sidebar">
      <div class="q-side-top tech-side-top">
        <div class="q-side-header">
          <div class="q-module-title"><i class="fas fa-wrench" aria-hidden="true"></i> Teknik</div>
          <button class="q-close" onclick="closeFullTech()"><i class="fas fa-times" aria-hidden="true"></i></button>
        </div>
        <div class="q-user-row">
          <div class="q-avatar" id="x-side-avatar">U</div>
          <div class="q-user">
            <div class="q-name" id="x-side-name">KullanÄ±cÄ±</div>
            <div class="q-role" id="x-side-role">Temsilci</div>
          </div>
        </div>
      </div>
      <div class="q-nav-menu">
        <div class="q-nav-item active" data-tech-tab="broadcast" onclick="switchTechTab('broadcast')"><i
            class="fas fa-tv" aria-hidden="true"></i> YayÄ±n SorunlarÄ±</div>
        <div class="q-nav-item" data-tech-tab="access" onclick="switchTechTab('access')"><i class="fas fa-wifi"
            aria-hidden="true"></i> EriÅŸim SorunlarÄ±</div>
        <div class="q-nav-item" data-tech-tab="app" onclick="switchTechTab('app')"><i class="fas fa-mobile-screen"
            aria-hidden="true"></i> App HatalarÄ±</div>
        <div class="q-nav-item" data-tech-tab="activation" onclick="switchTechTab('activation')"><i class="fas fa-bolt"
            aria-hidden="true"></i> Aktivasyon SorunlarÄ±</div>
        <div class="q-nav-item" data-tech-tab="payment" onclick="switchTechTab('payment')"><i class="fas fa-credit-card"
            aria-hidden="true"></i> Ã–deme SorunlarÄ±</div>
        <div class="q-nav-item" data-tech-tab="cards" onclick="switchTechTab('cards')"><i class="fas fa-layer-group"
            aria-hidden="true"></i> Teknik Terimler</div>
        <div class="q-nav-item" data-tech-tab="info" onclick="switchTechTab('info')"><i class="fas fa-circle-question"
            aria-hidden="true"></i> SÄ±k Sorulan Sorular</div>
      </div>
      <div class="q-side-bottom"><button class="q-logout" onclick="closeFullTech()"><i class="fas fa-arrow-left"
            aria-hidden="true"></i> Geri</button></div>
    </div>
    <div class="q-main">
      <div class="q-topbar">
        <div class="q-title">Teknik</div>
      </div>
      <div class="q-view">
        <section id="x-view-broadcast" class="q-view-section">
          <div class="q-split">
            <div class="q-pane">
              <div class="q-pane-title">YayÄ±n SorunlarÄ±</div>
              <div class="q-pane-search"><input id="x-broadcast-search" class="q-input" placeholder="Sorunlarda ara..."
                  oninput="filterTechDocList('broadcast')"></div>
              <div id="x-broadcast-list" class="q-accordion"></div>
            </div>
            <!-- Detay paneli kaldÄ±rÄ±ldÄ± -->
          </div>
        </section>
        <section id="x-view-access" class="q-view-section">
          <div class="q-split">
            <div class="q-pane">
              <div class="q-pane-title">EriÅŸim SorunlarÄ±</div>
              <div class="q-pane-search"><input id="x-access-search" class="q-input" placeholder="Sorunlarda ara..."
                  oninput="filterTechDocList('access')"></div>
              <div id="x-access-list" class="q-accordion"></div>
            </div>
            <!-- Detay paneli kaldÄ±rÄ±ldÄ± -->
          </div>
        </section>
        <section id="x-view-app" class="q-view-section">
          <div class="q-split">
            <div class="q-pane">
              <div class="q-pane-title">App HatalarÄ±</div>
              <div class="q-pane-search"><input id="x-app-search" class="q-input" placeholder="Sorunlarda ara..."
                  oninput="filterTechDocList('app')"></div>
              <div id="x-app-list" class="q-accordion"></div>
            </div>
            <!-- Detay paneli kaldÄ±rÄ±ldÄ± -->
          </div>
        </section>
        <section id="x-view-activation" class="q-view-section">
          <div class="q-split">
            <div class="q-pane">
              <div class="q-pane-title">Aktivasyon SorunlarÄ±</div>
              <div class="q-pane-search"><input id="x-activation-search" class="q-input" placeholder="Sorunlarda ara..."
                  oninput="filterTechDocList('activation')"></div>
              <div id="x-activation-list" class="q-accordion"></div>
            </div>
            <!-- Detay paneli kaldÄ±rÄ±ldÄ± -->
          </div>
        </section>
        <section id="x-view-payment" class="q-view-section">
          <div class="q-split">
            <div class="q-pane">
              <div class="q-pane-title">Ã–deme SorunlarÄ±</div>
              <div class="q-pane-search"><input id="x-payment-search" class="q-input" placeholder="Sorunlarda ara..."
                  oninput="filterTechDocList('payment')"></div>
              <div id="x-payment-list" class="q-accordion"></div>
            </div>
            <!-- Detay paneli kaldÄ±rÄ±ldÄ± -->
          </div>
        </section>
        <section id="x-view-info" class="q-view-section">
          <div class="q-split">
            <div class="q-pane">
              <div class="q-pane-title">SÄ±k Sorulan Sorular</div>
              <div class="q-pane-search"><input id="x-info-search" class="q-input" placeholder="Sorunlarda ara..."
                  oninput="filterTechDocList('info')"></div>
              <div id="x-info-list" class="q-accordion"></div>
            </div>
          </div>
        </section>
        <section id="x-view-wizard" class="q-view-section active">
          <div id="x-wizard" class="q-wizard"></div>
        </section>
        <section id="x-view-cards" class="q-view-section">
          <div class="q-toolbar"><input id="x-cards-search" class="q-input" placeholder="Teknik terimlerde ara..."
              oninput="filterTechCards()"></div>
          <div id="x-cards"></div>
        </section>
      </div>
    </div>
  </div>
  <script>
    /* Teknik menÃ¼ aktiflik dÃ¼zeltmesi (app.js'i bozmadan) */
    (function () {
      function fixActive(tab) {
        var root = document.getElementById('tech-fullscreen');
        if (!root) return;
        var items = root.querySelectorAll('.q-nav-menu .q-nav-item');
        items.forEach(function (el) {
          el.classList.toggle('active', el.getAttribute('data-tech-tab') === tab);
        });
      }

      var origSwitch = window.switchTechTab;
      window.switchTechTab = function (tab) {
        if (typeof origSwitch === 'function') origSwitch(tab);
        setTimeout(function () { fixActive(tab); }, 0);
      };

      var origOpen = window.openTechArea;
      window.openTechArea = function (tab) {
        if (typeof origOpen === 'function') origOpen(tab);
        setTimeout(function () { fixActive(tab || 'wizard'); }, 0);
      };
    })();
  </script>



  <script>
    // TeleSatÄ±ÅŸ sol menÃ¼: seÃ§ili sekmeyi (active) Teknik gibi renklendir
    document.addEventListener('click', (e) => {
      const item = e.target.closest('#telesales-fullscreen .q-nav-item');
      if (!item) return;
      const menu = item.parentElement;
      if (!menu) return;
      menu.querySelectorAll('.q-nav-item').forEach((el) => el.classList.remove('active'));
      item.classList.add('active');
    });
  </script>
</body>

</html>
